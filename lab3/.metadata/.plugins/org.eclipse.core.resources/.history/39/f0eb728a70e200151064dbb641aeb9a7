#include "ethernet_layer.h"

int ethPack(ethernetFrame* frame, char* output) {
    int s = 0;
    strncat(output, frame->dest_addr, s, 6);
    strncat(output, frame->src_addr, s, 6);
    strncat(output, frame->type, s, 2);
    strncat(output, frame->data, s, frame->dataLength);
    strncat(output, frame->checksum, s, 4);
    
    // destination address
    for (i = 0; i < 6; i++) {
         = [i];
    }
    
    // source address
    for (i = 0; i < 6; i++) {
        output[i + 6] = frame->src_addr[i];
    }
    
    // type
    for (i = 0; i < 2; i++) {
        output[i + 12] = frame->type[i];
    }
    
    // data
    for (i = 0; i < frame->dataLength; i++) {
        output[i + 14] = frame->data[i];
    }
    
    // checksum
    generateChecksum(frame->checksum);
    for (i = 0; i < 4; i++) {
        output[i + 14 + frame->dataLength] = frame->checksum[i];
    }
    
    return 18 + frame->dataLength;
}

void generateChecksum(char* dest) {
    dest[0] = 0x00;
    dest[1] = 0x00;
    dest[2] = 0x00;
    dest[3] = 0x20;
}
